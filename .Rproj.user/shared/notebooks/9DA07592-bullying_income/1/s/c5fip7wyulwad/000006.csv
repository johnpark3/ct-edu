"0","df1 <- read_csv(here(""edsight/raw_data"", ""bullying1318.csv""), skip=4) %>% "
"0","  select(-`District Code`)"
"0","enroll <- read_csv(here(""edsight/raw_data"", ""enrollment_district.csv""), skip=5, col_types = cols(.default = ""c"")) %>% "
"0","  rename(district = DISTRICT) %>% "
"0","  select(district, '2013-14':'2017-18') %>% "
"0","  dplyr::filter(.$'district' %in% nh_dists$'district') %>% "
"0","  mutate_at(c('2013-14', '2014-15', '2015-16', '2016-17', '2017-18'), as.numeric) %>% "
"0","  mutate(enrollment = rowSums(.[2:6])) %>% "
"0","  select(district, enrollment)"
"0","df <- df1 %>% "
"0","  gather(`year`, value, '2013-14':'2017-18') %>% "
"0","  "
"0","  # filter for GNH districts"
"0","  dplyr::filter(.$'District' %in% nh_dists$'district') %>% "
"0","  rename('district' = ""District"") %>% "
"0","  right_join(nh_dists, by = 'district') %>% "
"0"," "
"0","  drop_na() %>% # 152, 5 // 130, 5"
"0","  mutate_at('year', str_sub, start=1, end=4) %>% # first year of the school year"
"0","  mutate_at('year', as.numeric) %>% "
"0","  arrange(district, year) %>% "
"0","  filter(`Bullying Type` == ""Number of students with at least 1 bullying incident"")"
"0","df_low <- df %>% "
"0","  mutate_at(""value"", str_replace, pattern = ""\\*"", replacement = ""0"") %>% "
"0","  mutate_at(""value"", as.numeric) %>% "
"0","  group_by(district) %>% "
"0","  mutate(low = sum(value)) %>% "
"0","  ungroup() %>% "
"0","  filter(year == 2017) %>% "
"0","  select(ring, district, low) %>% "
"0","  left_join(enroll, by='district')  %>% "
"0","  mutate_at(""district"", str_replace, pattern = "" School District"", replacement = """") %>% "
"0","  mutate(low_rate = 10000*low/enrollment) %>% "
"0","  select(ring, district, low, low_rate)"
