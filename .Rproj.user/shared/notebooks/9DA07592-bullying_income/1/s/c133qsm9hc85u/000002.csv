"0","puma_xwalk <- readRDS(here(""_utils/region2puma.rds"")) %>%"
"0","  mutate(id = str_sub(id, -3, -1) %>% as.factor()) %>%"
"0","  filter(region == ""Greater New Haven"") %>% "
"0","  select(-region) %>% "
"0","  rename(region = puma)"
"0","pums_ddi <- read_ipums_ddi(here(""_utils/usa_00048.xml""))"
"0","pums <- read_ipums_micro(pums_ddi) %>%"
"0","  setNames(names(.) %>% str_to_lower()) %>%"
"0","  mutate_if(is.labelled, function(x) as_factor(lbl_clean(x))) %>%"
"0","  left_join(puma_xwalk, by = c(""puma"" = ""id""))%>%"
"0","  mutate(hhincome = as.numeric(as.character(hhincome))) %>%"
"0","  mutate(race = race %>%"
"0","           fct_recode(Black = ""Black/African American/Negro"") %>%"
"0","           fct_other(keep = c(""Black"", ""White""), other_level = ""Other race"")) %>%"
"0","  mutate(race2 = ifelse(hispan == ""Not Hispanic"", as.character(race), ""Latino"") %>% as_factor()) %>%"
"0","  select(-race:-hispand) %>%"
"0","  rename(race = race2) %>%"
"0","  mutate(hhtype = hhtype %>%"
"0","           fct_recode(""Single female"" = ""Female householder, no husband present"","
"0","                      ""Single male"" = ""Male householder, no wife present"","
"0","                      ""Married couple"" = ""Married-couple family household"")) %>%"
"0","  mutate(is_family = hhtype %in% c(""Single female"", ""Single male"", ""Married couple"")) %>% "
"0","  filter(!is.na(region))"
"1","Use of data from IPUMS-USA is subject to conditions including that users should
cite the data appropriately. Use command `ipums_conditions()` for more details.
"
