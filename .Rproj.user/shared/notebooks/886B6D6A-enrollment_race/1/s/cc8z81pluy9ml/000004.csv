"0","names <- c(""1718"", ""1617"", "
"0","           ""1516"", ""1415"", "
"0","           ""1314"", ""1213"", "
"0","           ""1112"", ""1011"")"
"0","df2 <- map_dfr (names, function(name) { "
"0","  read_csv(here(""edsight/raw_data"", str_glue(""StaffingRace_{name}.csv"")), skip = 2, col_types = ""ccccc"") %>% "
"0","    mutate(year = name)"
"0","  }"
"0","  )"
"0","df2 <- df2 %>%"
"0","  select(District, School, year, Race, Count) %>% "
"0","  mutate_at(c(""District"", ""School""), na.locf) %>% "
"0","  sapply(gsub, pattern = ""="", rep = """") %>% "
"0","  as_tibble %>% "
"0","  sapply(gsub, pattern = '""', rep = """") %>% "
"0","  as_tibble %>% "
"0","  na_if(""."") %>% "
"0","  drop_na %>% "
"0","  mutate_at(c('Count'), as.numeric) %>% "
"0","  mutate_all(funs(ifelse(is.na(.), 0, .))) %>% "
"0","  dplyr::filter(.$'District' %in% nh_dists$'district') %>% "
"0","  rename('district' = ""District"") %>% "
"0","  right_join(nh_dists, by = 'district') %>% "
"0","  group_by(district, year) %>% "
"0","  mutate(total = sum(Count)) %>% "
"0","  dplyr::filter(`Race` == ""White"") %>% "
"0","  mutate(tot_white = sum(Count)) %>% "
"0","  mutate(perc_white = 100 * tot_white / total) %>% "
"0","  mutate(staff = 100 - perc_white) %>% # percent minority staff"
"0","  select(region, district, year, staff) %>% "
"0","  distinct(region, district, year, staff)"
"0","dim(df2)"
"1","[1]"
"1"," 104"
"1","   4"
"1","
"
