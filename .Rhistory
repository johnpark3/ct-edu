mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
dplyr::filter(.$'District' %in% nh_dists$'district') %>%
rename('district' = "District") %>%
right_join(nh_dists, by = 'district') %>%
group_by(district, Year) %>%
mutate(total = sum(Value))
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[1]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[i]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
df <- bind_rows(df, temp)
}
df <- df %>%
as_tibble() %>%
mutate_at('Value', as.numeric) %>%
na_if(-9999) %>%
mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
dplyr::filter(.$'District' %in% nh_dists$'district') %>%
rename('district' = "District") %>%
right_join(nh_dists, by = 'district') %>%
group_by(district, Year) %>%
mutate(total = sum(Value))
df
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[1]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[i]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
df <- bind_rows(df, temp)
}
df <- df %>%
as_tibble() %>%
mutate_at('Value', as.numeric) %>%
na_if(-9999) %>%
mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
dplyr::filter(.$'District' %in% nh_dists$'district') %>%
rename('district' = "District") %>%
right_join(nh_dists, by = 'district') %>%
group_by(district, Year) %>%
mutate(total = sum(Value)) %>%
dplyr::filter('Race/Ethnicity' == "White") %>%
mutate(perc_white = 100 * Value / total)
df
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[1]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[i]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
df <- bind_rows(df, temp)
}
df <- df %>%
as_tibble() %>%
mutate_at('Value', as.numeric) %>%
na_if(-9999) %>%
mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
dplyr::filter(.$'District' %in% nh_dists$'district') %>%
rename('district' = "District") %>%
right_join(nh_dists, by = 'district') %>%
group_by(district, Year) %>%
mutate(total = sum(Value)) %>%
dplyr::filter(`Race/Ethnicity` == "White") %>%
mutate(perc_white = 100 * Value / total)
df
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[1]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[i]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
df <- bind_rows(df, temp)
}
df <- df %>%
as_tibble() %>%
mutate_at('Value', as.numeric) %>%
na_if(-9999) %>%
mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
dplyr::filter(.$'District' %in% nh_dists$'district') %>%
rename('district' = "District") %>%
right_join(nh_dists, by = 'district') %>%
group_by(district, Year) %>%
mutate(total = sum(Value)) %>%
dplyr::filter(`Race/Ethnicity` == "White") %>%
mutate(perc_white = 100 * Value / total) %>%
select(region, district, year, perc_white)
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[1]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[i]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
df <- bind_rows(df, temp)
}
df <- df %>%
as_tibble() %>%
mutate_at('Value', as.numeric) %>%
na_if(-9999) %>%
mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
dplyr::filter(.$'District' %in% nh_dists$'district') %>%
rename('district' = "District") %>%
right_join(nh_dists, by = 'district') %>%
group_by(district, Year) %>%
mutate(total = sum(Value)) %>%
dplyr::filter(`Race/Ethnicity` == "White") %>%
mutate(perc_white = 100 * Value / total) %>%
select(region, district, Year, perc_white)
df
unique(df$district)
df %>% ggplot(aes(perc_white, district))
df %>% ggplot(aes(perc_white, district)) +
geom_line()
df %>% ggplot(aes(year, perc_white)) +
geom_line(color=district)
df %>% ggplot(aes(year, perc_white)) +
geom_line()
df %>% ggplot(aes(Year, perc_white)) +
geom_line()
df %>% ggplot(aes(Year, perc_white)) +
geom_line() +
geom_point()
df %>% ggplot(aes(x = Year, y = perc_white, group = district)) +
geom_line() +
geom_point()
geom_line(aes(linetype=supp) +
df %>% ggplot(aes(x = Year, y = perc_white, group = district)) +
geom_line(aes(linetype=supp)) +
geom_point()
df %>% ggplot(aes(x = Year, y = perc_white, group = district)) +
df %>% ggplot(aes(x = Year, y = perc_white, group = district)) +
geom_line(aes(linetype = district)) +
geom_point()
df %>% ggplot(aes(x = Year, y = perc_white, group = district)) +
geom_line(aes(linecolor = district)) +
geom_point()
df %>% ggplot(aes(x = Year, y = perc_white, group = district)) +
geom_line(aes(color = district)) +
geom_point()
df %>% ggplot(aes(x = Year, y = perc_white, group = district)) +
geom_line(aes(color = district)) +
geom_point() +
theme(axis.text.x = element_text(angle = 30, hjust = 1))
df %>%
filter(region == "New Haven Inner Ring") %>%
ggplot(aes(x = Year, y = perc_white, group = district)) +
geom_line(aes(color = district)) +
geom_point() +
theme(axis.text.x = element_text(angle = 30, hjust = 1))
df %>%
filter(region == "New Haven Inner Ring") %>%
ggplot(aes(x = Year, y = perc_white, group = district)) +
geom_line(aes(color = district)) +
geom_point() +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
df %>%
filter(region == "New Haven Outer Ring") %>%
ggplot(aes(x = Year, y = perc_white, group = district)) +
geom_line(aes(color = district)) +
geom_point() +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[1]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[i]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
df <- bind_rows(df, temp)
}
df <- df %>%
as_tibble() %>%
mutate_at('Value', as.numeric) %>%
na_if(-9999) %>%
mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
dplyr::filter(.$'District' %in% nh_dists$'district') %>%
rename('district' = "District") %>%
right_join(nh_dists, by = 'district') %>%
group_by(district, Year) %>%
mutate(total = sum(Value)) %>%
dplyr::filter(`Race/Ethnicity` == "White") %>%
mutate(perc_white = 100 * Value / total) %>%
mutate(perc_minority = 100 - perc_white) %>%
select(region, district, Year, perc_minority)
unique(df$district)
df %>% ggplot(aes(x = Year, y = perc_white, group = district)) +
geom_line(aes(color = district)) +
geom_point() +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
df %>% ggplot(aes(x = Year, y = perc_minority, group = district)) +
geom_line(aes(color = district)) +
geom_point() +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
df %>%
filter(region == "New Haven Inner Ring") %>%
ggplot(aes(x = Year, y = perc_minority, group = district)) +
geom_line(aes(color = district)) +
geom_point() +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
df %>%
filter(region == "New Haven Outer Ring") %>%
ggplot(aes(x = Year, y = perc_minority, group = district)) +
geom_line(aes(color = district)) +
geom_point() +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")))
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=3) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble %>%
na_if(".")
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=1)
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=1) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble %>%
na_if(".")
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=1) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble %>%
na_if(".")
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=1)
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2)
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble %>%
na_if(".")
df %>%
as_tibble() %>%
mutate_at('Value', as.numeric) %>%
na_if(-9999) %>%
mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
dplyr::filter(.$'District' %in% nh_dists$'district') %>%
rename('district' = "District") %>%
right_join(nh_dists, by = 'district') %>%
group_by(district, Year) %>%
mutate(total = sum(Value)) %>%
dplyr::filter(`Race/Ethnicity` == "White") %>%
mutate(perc_white = 100 * Value / total) %>%
mutate(perc_minority = 100 - perc_white)
source(here("edsight/_utils/edsight_functions.R"))
nh_dists <- school_dists %>%
dplyr::filter(region %in% c("New Haven Inner Ring", "New Haven Outer Ring")) %>%
rbind(c("New Haven Inner Ring", "New Haven"))
nh_dists$district <- nh_dists$district %>%
paste("School District")
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[1]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("enrollment_race_{names[i]}.rds"))) %>%
select(District, Year, 'Race/Ethnicity', Value)
df <- bind_rows(df, temp)
}
df <- df %>%
as_tibble() %>%
mutate_at('Value', as.numeric) %>%
na_if(-9999) %>%
mutate_all(funs(ifelse(is.na(.), 0, .))) %>%
dplyr::filter(.$'District' %in% nh_dists$'district') %>%
rename('district' = "District") %>%
right_join(nh_dists, by = 'district') %>%
group_by(district, Year) %>%
mutate(total = sum(Value)) %>%
dplyr::filter(`Race/Ethnicity` == "White") %>%
mutate(perc_white = 100 * Value / total) %>%
mutate(perc_minority = 100 - perc_white) %>%
select(region, district, Year, perc_minority)
unique(df$district)
df %>% ggplot(aes(x = Year, y = perc_minority, group = district)) +
geom_line(aes(color = district)) +
geom_point() +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
df %>%
filter(region == "New Haven Inner Ring") %>%
ggplot(aes(x = Year, y = perc_minority, group = district)) +
geom_line(aes(color = district)) +
geom_point() +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
df %>%
filter(region == "New Haven Outer Ring") %>%
ggplot(aes(x = Year, y = perc_minority, group = district)) +
geom_line(aes(color = district)) +
geom_point() +
theme(axis.text.x = element_text(angle = 20, hjust = 1))
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble %>%
na_if(".") %>%
select(District, Year, 'Race/Ethnicity', Value)
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2)
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf)
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf)
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf)
read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble %>%
select(District, 'Race/Ethnicity', Value)
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble %>%
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("StaffingRace_{names[i]}.rds"))) %>%
df <- bind_rows(df, temp)
}
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble %>%
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("StaffingRace_{names[i]}.rds"))) %>%
df <- bind_rows(df, temp)
}
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
df
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("StaffingRace_{names[i]}.rds"))) %>%
df <- bind_rows(df, temp)
}
temp <- readRDS(here("ctsde/outputs", str_glue("StaffingRace_{names[i]}.csv"))) %>%
df <- bind_rows(df, temp)
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("StaffingRace_{names[i]}.csv"))) %>%
df <- bind_rows(df, temp)
}
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[2]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
df
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[2]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
df
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[3]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
df
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[4]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
df
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[5]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
df
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[6]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[6]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[7]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[8]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[8]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
for (i in 2:(length(names))) {
temp <- readRDS(here("ctsde/outputs", str_glue("StaffingRace_{names[i]}.csv"))) %>%
df <- bind_rows(df, temp)
}
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[8]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
for (i in 2:(length(names))) {
temp <- readRDS(here("edsight/raw_data", str_glue("StaffingRace_{names[i]}.csv"))) %>%
df <- bind_rows(df, temp)
}
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[8]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
for (i in 2:(length(names))) {
temp <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[i]}.csv")), skip=2) %>%
df <- bind_rows(df, temp)
}
names <- c("1718", "1617",
"1516", "1415",
"1314", "1213",
"1112", "1011")
df <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[1]}.csv")), skip=2) %>%
mutate_at(c("District", "School"), na.locf) %>%
sapply(gsub, pattern = "=", rep = "") %>%
as_tibble %>%
sapply(gsub, pattern = '"', rep = "") %>%
as_tibble
for (i in 2:(length(names))) {
temp <- read_csv(here("edsight/raw_data", str_glue("StaffingRace_{names[i]}.csv")), skip=2) %>%
df <- bind_rows(df, temp)
}
